var Header=function(element){this.div=element;this.loggedContent=$(this.div).data("logged-content");this.logoutUrl="";this.logoutId='[data-id="mainheader__logout"]';this.clearData();this.bindEvents(this);this.init()};Header.prototype.clearData=function(){$(this.div).removeAttr("data-logged-content")};Header.prototype.bindEvents=function(selfReference){$(this.div).on("click",this.logoutId,function(){selfReference.doLogout()})};Header.prototype.init=function(){if(parseInt(Cookies.get("cs_logged"))===1){this.showLogged()}};Header.prototype.doLogout=function(){var _ajaxRequest=new AjaxRequest({successCallback:function(){Cookies.remove("cs_logged");location.reload()}});_ajaxRequest.makeCall(this.logoutUrl)};Header.prototype.showLogged=function(){var _ulLinks=$(this.div).find('[data-id="mainheader__links"]');if(_ulLinks.length>0){$(_ulLinks).html(this.loggedContent);var _logoutButton=$(this.div).find(this.logoutId);this.logoutUrl=$(_logoutButton).data("logout-url");$(_logoutButton).removeAttr("data-logout-url")}};document.addEventListener("DOMContentLoaded",function(){$('[data-id="mainheader__container"]').each(function(){new Header(this)})});document.addEventListener("comitium.gallery.image.displayed",function(event){window.currentData=JSON.stringify({title:$("title").text(),description:$('meta[property="og:description"]').attr("content"),url:$('meta[property="og:url"]').attr("content"),image:{url:$('meta[property="og:image"]').attr("content"),width:$('meta[property="og:image:width"]').attr("content"),height:$('meta[property="og:image:height"]').attr("content")}});if(event.detail.galleryType==="horizontal"){if(typeof window.lazyLoad!=="undefined"){window.lazyLoad.update()}}var _body=document.getElementById("mainarticle-body");var _image=event.detail.element[0];if(event.detail.galleryType==="vertical"){var head=$("head");var articlePermalink=$(_body).data("article-permalink");var galleryImageId=$(_image).data("image-id");var firstPartNewLink=articlePermalink.replace("102.html","102/");var newLink=firstPartNewLink.concat(galleryImageId,".html");var figureParent=$(_image).find("[data-id='c-gallery__fig']");var h3Element=$(figureParent).find('[data-role="title"]');var title=h3Element.length>0?h3Element.text():$("title",head).text();var pElement=$(figureParent).find('[data-role="description"]');var description=pElement.length>0?pElement.text():$('meta[name="description"]',head).attr("content");var newData={title:title,description:description,url:newLink,image:{url:_image.getAttribute("src"),width:_image.getAttribute("width"),height:_image.getAttribute("height")}};var newJsonData=JSON.stringify(newData);if(newJsonData!=window.currentData){$("title",head).text(title);$('meta[property="og:title"]',head).attr("content",title);$('meta[name="title"]',head).attr("content",title);$('meta[name="description"]',head).attr("content",description);$('meta[property="og:description"]',head).attr("content",description);$('meta[name="twitter:description"]',head).attr("content",description);$('meta[name="twitter:image:src"]',head).attr("content",newLink);$('meta[property="og:image"]',head).attr("content",newLink);$('meta[property="og:image:width"]',head).attr("content",_image.getAttribute("width"));$('meta[property="og:image:height"]',head).attr("content",_image.getAttribute("height"));$('meta[name="twitter:url"]',head).attr("content",newLink);$('meta[property="og:url"]',head).attr("content",newLink);if(typeof history.replaceState!=="undefined"){history.replaceState({},title,newLink)}if(typeof gtag!=="undefined"){gtag("event","page_view",{title:document.title,location:location.href,page:location.pathname})}else if(typeof ga!=="undefined"){ga("send",{hitType:"pageView",title:document.title,location:location.href,page:location.pathname})}window.currentData=newJsonData}}});var galleryManager=new ComitiumGalleryManager,pollManager=new ComitiumPollManager;galleryManager.init();var HorizontalGallery=function(element){var _swiper=new Swiper(element,{loop:true,navigation:{nextEl:element.find(".swiper-button-next"),prevEl:element.find(".swiper-button-prev")},on:{slideChangeTransitionEnd:function(){onVisualizeImage(element.find(".swiper-slide-active img[data-image]"))}}});function onVisualizeImage(image){}};var NumComments=function(element){this._element=element;this._url="";this.getData();this.clearData();this.init()};NumComments.prototype.getData=function(){this._url=$(this._element).data("num-comments-url")};NumComments.prototype.clearData=function(){$(this._element).removeAttr("data-num-comments-url")};NumComments.prototype.init=function(){var _this=this;var _ajaxRequest=new AjaxRequest({requestType:"get",successCallback:function(response){$(_this._element).html(response.message)}});_ajaxRequest.makeCall(this._url)};$('[data-id="horizontal-related-gallery"]').each(function(){new HorizontalGallery($(this))});$('[data-id="article-numComments"]').each(function(){new NumComments($(this))});window.SocialAnalytics=new SocialAnalytics;window.ScrollAnalytics=new ScrollAnalytics;var WComments=function(element){this._notLoggedDiv=element;this._loggedContentUrl="";this._renderCommentsUrl="";this._cookieName="cs_logged";this._form="";this._counterDiv="";this._maxLength="";this._forceLoggedContent="";this._commentsTop=-1;this._scrolled=false;this.getData();this.clearData();this.bindEvents();this.init()};WComments.prototype.getData=function(){this._loggedContentUrl=$(this._notLoggedDiv).data("comment-login");this._renderCommentsUrl=$(this._notLoggedDiv).data("comment-render");this._forceLoggedContent=$(this._notLoggedDiv).data("force-logged-content")};WComments.prototype.clearData=function(){$(this._notLoggedDiv).removeAttr("data-comment-login");$(this._notLoggedDiv).removeAttr("data-comment-render");$(this._notLoggedDiv).removeAttr("data-force-logged-content")};WComments.prototype.bindEvents=function(){var _this=this;$(this._form).on("keyup",'[data-id="comment_textarea"]',function(event){_this.updateCounter(event,this)});$(window).on("scroll",function(event){_this.windowScrolled(event,window.scrollY)})};WComments.prototype.init=function(){var _this=this;var _cookie=Cookies.get(this._cookieName);if(_cookie!==undefined||this._forceLoggedContent){var _ajaxRequest=new AjaxRequest({successCallback:function(response){$(_this._notLoggedDiv).html(response.message);_this._form=$(_this._notLoggedDiv).find('[data-container="comments-form"]');_this._counterDiv=$(_this._form).find('[data-id="characters-count"]');_this._maxLength=$(_this._counterDiv).data("max-length");$(_this._counterDiv).removeAttr("data-max-length");var _commentsDiv=$(_this._notLoggedDiv).find("[data-comments-container]");_this._commentsTop=_commentsDiv.offset().top-1e3}});_ajaxRequest.makeCall(this._loggedContentUrl,{},{type:"get"})}};WComments.prototype.updateCounter=function(event,element){event.preventDefault();var _content=$(element).val();var _contentLength=_content.length;var _newCounter=_contentLength+"/"+this._maxLength;this._counterDiv.html(_newCounter);if(_contentLength>=this._maxLength){$(this._counterDiv).addClass("limit_reached")}else{$(this._counterDiv).removeClass("limit_reached")}};WComments.prototype.windowScrolled=function(event,scroll){if(this._commentsTop>0&&scroll>this._commentsTop&&this._scrolled===false){this._scrolled=true;var _this=this;var _ajaxRequest=new AjaxRequest({successCallback:function(response){$(_this._notLoggedDiv).find("[data-comments-container]").html(response.message);_this.bindEvents();var _comments=new Comments({topOffset:95});_comments.reloadCaptcha();$(response.message).find(".c-ads").each(function(_idx,el){var idBanner=$(el).attr("id");var event=new CustomEvent("generateCommentsBanner",{detail:{format:idBanner}});document.dispatchEvent(event)})}});_ajaxRequest.makeCall(this._renderCommentsUrl,{},{type:"get"})}};$('[data-id="comments-not-logged"]').each(function(){console.log("comments-not-logged");console.log(this);new WComments(this)});var HoyDescatamos=function(element){this.div=element;this.url=$(this.div).data("url");this.articleId=$(this.div).data("article-id");this.clearData();this.init()};HoyDescatamos.prototype.clearData=function(){$(this.div).removeAttr("data-url");$(this.div).removeAttr("data-article-id")};HoyDescatamos.prototype.init=function(){var _div=this.div;var _this=this;var ajaxRequest=new AjaxRequest({type:"get",successCallback:function(response){$(_div).replaceWith(response.message);window.lazyLoad.update();window.gtag("event","page_view",{title:"Portada",location:location.protocol+"//"+location.hostname,page:"/"});$(".c-news-list__list .c-ads").each(function(_idx,el){var idBanner=$(el).attr("id");var event=new CustomEvent("generateHoyDestacamosBanner",{detail:{format:idBanner}});document.dispatchEvent(event)})}});const HoyDestacamosInit=function(){if($(_div).offset().top-2500<window.pageYOffset){ajaxRequest.makeCall(_this.url,{articleId:_this.articleId},{type:"get"});document.removeEventListener("scroll",HoyDestacamosInit)}};document.addEventListener("scroll",HoyDestacamosInit)};$('[data-id="c-hoy-destacamos"]').each(function(){new HoyDescatamos(this)});var Ranking=function(element){this.div=element;this.url=$(this.div).data("url");this.clearData();this.init()};Ranking.prototype.clearData=function(){$(this.div).removeAttr("data-url")};Ranking.prototype.init=function(){var _div=this.div;var ajaxRequest=new AjaxRequest({successCallback:function(response){$(_div).replaceWith(response.message);lazyLoad.update()}});ajaxRequest.makeCall(this.url,{},{type:"get"})};document.addEventListener("DOMContentLoaded",function(){$('[data-id="c-ranking"]').each(function(){new Ranking(this)})});var ReviveBannerInterstitial=function(element){this._container=element;this._banner="";this._autoCloseTime="";this._reloadTime="";this._zoneId="";this._timeOut="";this.getData();this.clearData();this.bindEvents();this.init()};ReviveBannerInterstitial.prototype.getData=function(){this._banner=$(this._container).data("banner");this._autoCloseTime=$(this._container).data("auto-close-time");this._reloadTime=$(this._container).data("time-to-reload");this._zoneId=$(this._container).data("zone-id")};ReviveBannerInterstitial.prototype.clearData=function(){$(this._container).removeAttr("data-banner");$(this._container).removeAttr("data-auto-close-time");$(this._container).removeAttr("data-time-to-reload");$(this._container).removeAttr("data-zone-id")};ReviveBannerInterstitial.prototype.bindEvents=function(){var _this=this;$(this._container).on("click","[data-modal-close]",function(event){event.preventDefault();_this.hideModal()})};ReviveBannerInterstitial.prototype.init=function(){if(typeof Cookies.get("cs_logged")==="undefined"){if(this._banner){var _bannerContainer=$(this._container).find('[data-id="revive_banner_container"]');$(_bannerContainer).replaceWith(this._banner)}this.displayModal()}};ReviveBannerInterstitial.prototype.displayModal=function(){var _cookie=this.getCookie();var _time=parseInt(_cookie,10);if(isNaN(_time)){this.showModal()}else{if(_time>0){var _timeToReload=_time+this._reloadTime*60;if(_timeToReload<Math.floor((new Date).getTime()/1e3)){this.showModal()}}}};ReviveBannerInterstitial.prototype.showModal=function(){$(this._container).fadeIn();this.autoCloseBanner()};ReviveBannerInterstitial.prototype.hideModal=function(){if(this._timeOut){clearTimeout(this._timeOut)}$(this._container).fadeOut();this.setCookie()};ReviveBannerInterstitial.prototype.setCookie=function(){if(this._reloadTime>0){localStorage.setItem("closed-modal-"+this._zoneId,Math.floor((new Date).getTime()/1e3))}else{localStorage.setItem("closed-modal-"+this._zoneId,"0")}};ReviveBannerInterstitial.prototype.getCookie=function(){return localStorage.getItem("closed-modal-"+this._zoneId)};ReviveBannerInterstitial.prototype.autoCloseBanner=function(){var _this=this;if(this._autoCloseTime>0){this._timeOut=setTimeout(function(){_this.hideModal()},this._autoCloseTime*1e3)}};var ReviveBanner=function(element){this._container=element;this._banner="";this.getData();this.clearData();this.init()};ReviveBanner.prototype.getData=function(){this._banner=$(this._container).data("banner")};ReviveBanner.prototype.clearData=function(){$(this._container).removeAttr("data-banner")};ReviveBanner.prototype.init=function(){if(typeof Cookies.get("cs_logged")==="undefined"){$(this._container).replaceWith(this._banner)}};loadingIntersticial=false;$(window).scroll(function(){if(!loadingIntersticial&&typeof existIntersticialBanner!=="undefined"&&(document.body.scrollTop>150||document.documentElement.scrollTop>150)){loadingIntersticial=true;$('[data-id="revive_banner"]').each(function(){new ReviveBanner(this)});$('[data-id="revive-banner-interstitial-modal"]').each(function(){new ReviveBannerInterstitial(this)})}});